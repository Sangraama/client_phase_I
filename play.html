<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Sangraama:සංග්‍රාම</title>
<!-- Page metadata -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="Game Client">
<meta name="author" content="">

<!-- Add style sheets and responsive design -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
<link href="css/bootstrap-responsive.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/login.css">
<!-- Add java script libraries -->
<!-- <script type="text/javascript" src="js/lib/jquery-1.9.1.js"></script> -->
<script type="text/javascript" src="js/lib/jquery-2.0.2.js"></script>
<script type="text/javascript" src="js/lib/bootstrap.js"></script>
<script type="text/javascript" src="js/lib/underscore.js"></script>
<script type="text/javascript" src="js/lib/jquery.json-2.4.min.js"></script>
<script type="text/javascript" src="js/lib/jquery.websocket-0.0.4.js"></script>
<script type="text/javascript" src="js/lib/box2d.js"></script>
<!-- Add Sangraama customize java scripts -->
<script type="text/javascript" src="js/sangraamaclient.js"></script>
<script type="text/javascript" src="js/mapLoader.js"></script>
<script type="text/javascript" src="js/utils.js"></script>
<script type="text/javascript" src="js/aoihandler.js"></script>
<script type="text/javascript" src="js/graphic.js"></script>
<script type="text/javascript" src="js/wshandler.js"></script>
<script type="text/javascript" src="js/keymap.js"></script>
</head>

<body id="body">
<div class="navbar" style = "margin-bottom: 42px;">
    <div class="navbar-inner">
        <a class="brand" href="#">සංග්‍රාම</a>
        <div class="control-group">
            <button id="start" class="btn btn-warning" type="button">Start Game</button>
            <button id="stop" class="btn btn-danger" type="button">Stop Game</button>

           <div class="score-panel">
               <label>Score : </label>
                <label id="score">100</label>

                <label>Life  </label>
                <label id="life"><div class="progress progress-info">
                    <div id="life_progress" class="bar" style="width: 20%"></div>
                </div></label>

            </div>
        </div>


    </div>
</div>

<div style="position: relative;">
    <canvas id="layer1" style="position: absolute; z-index: 0; margin-top:-40px;"></canvas>
    <canvas id="layer2" style="position: absolute; z-index: 1; margin-top:-40px;"></canvas>
</div>


<script type="text/javascript">
  $('#stop').prop('disabled',true).blur();
  $('#start').click(function() {
      player.userID = Math.floor(Math.random() * 1000) + 1;
      console.log('player id:' + player.id);
      var hostLocation = 'localhost:8080';
      var URL = hostLocation + '/sangraama-server/sangraama/player';
      // start wsList with 0 index
      wsList[0] = new WebSocketHandler(URL, 0);
      wsList[0].connect();
      // Set initial virtual point location as player location
      aoihandler.setVirtualPoint(player.x,player.y);

      // Clear the map before start game @assign: Amila
      
      mapLoader.drawMap(player.x, player.y);
      // Disable start and enable stop game
      $('#start').prop('disabled',true).blur();
      $('#stop').prop('disabled',false);
  });

  $('#stop').click(function() {
    // Close all opened websockets
    for ( var i = 0; i < 10; i++) {
      if (wsList[i] != null || wsList[i] != undefined) {
        if (primaryCon == i) {
          primaryCon--;
        }
        console.log('Stopped the connection ' + wsList[i].getHostAddress());
        wsList[i].close(i);// try closing connection
      }
    }
    primaryCon = 0;
    // Disable stop and enable start game
    $('#stop').prop('disabled',true);
    $('#start').prop('disabled',false);
  });
</script>


</body>
</html>


<!--
to update life progress
   $("#life_progress").css({"width": "50%"})

to remove progress current css class
    $("#life_progress").parent(".progress").removeClass("progress-info")

to add new css class to progress
    $("#life_progress").parent(".progress").addClass("progress-success")

-->
