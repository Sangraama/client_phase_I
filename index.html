<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <title>Sangraama:සංග්‍රාම</title>
        
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-29231762-1']);
    _gaq.push(['_setDomainName', 'dzyngiri.com']);
    _gaq.push(['_trackPageview']);
  
    /*(function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();*/
  </script>


<!--Stylesheets-->
<link href="css/login.css" rel="stylesheet" type="text/css" />
<link href="fonts/pacifico/stylesheet.css" rel="stylesheet" type="text/css" />

<!--Scripts-->
<script type="text/javascript" src="js/lib/jquery-2.0.2.js"></script>
<!--Sliding icons-->
<script type="text/javascript">
$(document).ready(function() {
  $(".username").focus(function() {
    $(".user-icon").css("left","-48px");
  });
  $(".username").blur(function() {
    $(".user-icon").css("left","0px");
  });
  
  $(".password").focus(function() {
    $(".pass-icon").css("left","-48px");
  });
  $(".password").blur(function() {
    $(".pass-icon").css("left","0px");
  });
});
</script>

</head>
<body>

  <div class="heading">
      Sangraama : සංග්‍රාම
    </div>
    
<div id="wrapper">
  <!--Sliding icons-->
    <div class="user-icon"></div>
    <div class="pass-icon"></div>
    <!--END Sliding icons-->

<!--login form inputs-->
<form name="login-form" class="login-form" action="" method="post">

  <!--Header-->
    <div class="header">
    <h1>Login Form</h1>
    <span>Please login by using this login form or if you dont have an account, you can Register!</span>
    </div>
    <!--END header-->
  
  <!--Input fields-->
    <div class="content">
  <!--USERNAME--><input id = "userName" name="username" type="text" class="input username" placeholder="Username" /><!--END USERNAME-->
    <!--PASSWORD--><input id = "password" name="password" type="password" class="input password" placeholder="Password" /><!--END PASSWORD-->
    </div>
    <!--END Input fields-->
    
    <!--Buttons-->
    <div class="footer">
    <!--Login button--><input type="button" name="submit" value="Login" class="button" onclick="checkUser()" /><!--END Login button-->
    <!--Register button--><input type="submit" name="submit" value="Register" class="register" /><!--END Register button-->
    </div>
    <!--END Buttons-->

</form>
<!--end login form-->

</div>

<!--bg gradient--><div class="gradient"></div><!--END bg gradient-->
<script type="text/javascript">
 window.onload = function() {
  connect();
 }
  var ws;
  function connect() {
    
    if ('MozWebSocket' in window) {
      ws = new MozWebSocket('ws://localhost:8080/Login-Server/sangraama/player');
    } else if ('WebSocket' in window) {
      ws = new WebSocket('ws://localhost:8080/Login-Server/sangraama/player');
    } else {
      alert('Your browser does not support WebSockets');
    }
    ws.onopen = function() {
      console.log('Connection opened');
    };
    ws.onmessage = function(event) {
      var user = JSON.parse(event.data);
      console.log(event.data);
      switch(user.type){
        case 1:
      window.localStorage.setItem("user", event.data);
        window.location.href='menu.html';
        break;
        default:
      }
      /*clear();
      for ( var index in players) {
        var inPlayer = players[index];
        if (inPlayer.type == 1) {
          drawRotatedImage(ship, inPlayer);
        } else if (player.id == inPlayer.id) {
          ws.close();
          connect(inPlayer.url);
        }
      }*/
    };
    ws.onclose = function() {
      console.log('Connection closed');
    };
    ws.onerror = function(event) {
      console.log('Connection error');
    };
    // window.location.href='menu.html';
  }


  function checkUser(){
    var msg = {type : 1,
      username:$("#userName ").val(),
    password : $("#password ").val()
  };
  ws.send(JSON.stringify(msg));
  // window.localStorage.setItem("test", JSON.stringify(msg));
// window.location.href='menu.html';
/* Page B */

  }
  </script>


</body>
</html>